{% extends 'cards/base.html' %}

{% block back %}
{% if card.language in person.languages %}

<a href="{% url 'my_deck' card.language.name %}">
  <i class="fa fa-arrow-circle-left"></i> back to {{ card.language }} deck
</a>

{% endif %}
{% endblock %}

{% block content %}
<section class="card container">
  <div class="row">
    <div class="col-md-12">
      <h4 class="">{{ card.language.name }}{% if membership %}, {{ membership.status }}{% endif %}</h4>
      <h1>{{ card.text }}</h1>

    </div>
  </div>
  <div class="row">
    <div class="col-md-12 text-md-right">
      <h4 class="">{{ person.speaks_languages.all|join:", " }}</h4>
      <div class="blockquote m-y-2">
        {% for phrase in card.cardtranslation_set.all %}
        <h3 class="text-muted"><em>&ldquo;{{ phrase.text }}&rdquo;</em></h3>
        {% endfor %}
      </div>
    </div>

    {% if card.see_also.count %}
    <div class="col-md-6">
      <h4>Related</h4>
      <div class="">
        {% for phrase in card.see_also.all %}
        <h3><a href="{% url 'card_detail' phrase.id %}">{{ phrase.text }}</a></h3>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
  {% if deck %}
  <form method="post" role="form" action="{% url 'membership_update' card.id %}">
    {% csrf_token %}
    <div class="row m-y-2">
      <div class="col-md-4 m-b-1">
        {% if membership.status == 'learned' %}
        <button type="submit" name="status" value="learned" class="p-y-2 btn btn-block btn-success btn-lg">
          <i class="fa fa-star fa-lg"></i> Learned
        </button>
        {% elif membership.status == 'learning' %}
        <button type="submit" name="status" value="learned" class="p-y-2 btn btn-block btn-outline-success btn-lg">
          <i class="fa fa-star-o fa-lg"></i> Learned this!
        </button>
        {% else %}
        <button type="submit" name="status" value="learned" class="p-y-2 btn btn-block btn-outline-success btn-lg">
          <i class="fa fa-star-o fa-lg"></i> I know this!
        </button>
        {% endif %}
      </div>

      <div class="col-md-4 m-b-1">
        {% if membership.status == 'learning' %}
        <button type="submit" name="status" value="learning" class="p-y-2 btn btn-block btn-primary btn-lg">
          <i class="fa fa-star-half-o fa-lg"></i> Learning
        </button>
        {% elif membership.status == 'learned' %}
        <button type="submit" name="status" value="learning" class="p-y-2 btn btn-block btn-outline-primary btn-lg">
          <i class="fa fa-star-half-o fa-lg"></i> Still learning
        </button>
        {% else %}
        <button type="submit" name="status" value="learning" class="p-y-2 btn btn-block btn-outline-primary btn-lg">
          <i class="fa fa-download fa-lg"></i> Add to deck
        </button>
        {% endif %}
      </div>

      <div class="col-md-4 m-b-1">
        {% ifequal membership.status 'rejected' %}
        <button type="submit" name="status" value="rejected" class="p-y-2 btn btn-block btn-danger btn-lg">
          <i class="fa fa-times-circle fa-lg"></i> Rejected
        </button>
        {% else %}
        <button type="submit" name="status" value="rejected" class="p-y-2 btn btn-block btn-outline-danger btn-lg">
          <i class="fa fa-times-circle fa-lg"></i> Discard
        </button>
        {% endifequal %}
      </div>
    </div>
  </form>
  {% else %}
  <a href="{% url 'deck_add' %}" class="btn btn-primary btn-block btn-lg m-y-2 p-a-2">
    Start learning {{ card.language }}
  </a>
  {% endif %}

</section>
{% endblock %}
